Metadata-Version: 2.4
Name: smart-excel-copilot
Version: 1.0.0rc3
Summary: Smart Excel Copilot - AI-powered Excel automation and reporting
Author-email: Excel Copilot Team <team@excelcopilot.ai>
Project-URL: Homepage, https://github.com/excel-auto/excel-auto
Project-URL: Repository, https://github.com/excel-auto/excel-auto.git
Project-URL: Issues, https://github.com/excel-auto/excel-auto/issues
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: pandas>=2.0.0
Requires-Dist: openpyxl>=3.1.2
Requires-Dist: streamlit>=1.28.0
Requires-Dist: pyyaml>=6.0
Requires-Dist: pathlib2>=2.3.7
Provides-Extra: watch
Requires-Dist: watchdog>=4.0.0; extra == "watch"
Provides-Extra: excel
Requires-Dist: openpyxl>=3.1.2; extra == "excel"
Provides-Extra: fastio
Requires-Dist: pyarrow>=15.0.0; extra == "fastio"

# Smart Excel Copilot

**v0.5.0-rc2** - LLM í´ë°± + ìì—°ì–´ í•„í„° + COM ì•ˆì •í™” í¬í•¨

Excel ë°ì´í„° ì „ì²˜ë¦¬ë¥¼ ìœ„í•œ Python ê¸°ë°˜ ë„êµ¬ì…ë‹ˆë‹¤.

## ğŸš€ í€µìŠ¤íƒ€íŠ¸

### í•„ìˆ˜ ì„¤ì • (PowerShellì—ì„œ ì‹¤í–‰)
```bash
.\setup_console.ps1                    # ì½˜ì†” í•œê¸€ ê³ ì •
.\install.ps1                          # ê¸°ë³¸ íŒ¨í‚¤ì§€ ì„¤ì¹˜
.\install_ollama.ps1                   # ìì—°ì–´ íŒŒì„œ ì„¤ì • (ì„ íƒ)
```

### ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
```bash
python -m app.cli profile --path data/goldensets/s01_mixed_currency.csv
python -m app.cli preprocess --path data/goldensets/s01_mixed_currency.csv --apply
python -m app.cli excel-auto --path data/goldensets/s01_mixed_currency.csv --ask "ì›”ë³„ ì¹´í…Œê³ ë¦¬ ë§¤ì¶œ í”¼ë²—ê³¼ ë§‰ëŒ€ì°¨íŠ¸"
```

### ğŸŒ Streamlit UI ì‚¬ìš©ë²•

```bash
# PowerShellì—ì„œ ì‹¤í–‰
.\run_ui.ps1

# ë˜ëŠ” ì§ì ‘ ì‹¤í–‰
$env:PYTHONPATH=".;smart_excel_copilot"
streamlit run tools/ui_copilot.py
```

**UI ê¸°ëŠ¥:**
- ğŸ” **í”„ë¡œíŒŒì¼ë§**: ë°ì´í„° êµ¬ì¡° ë° í†µê³„ ë¶„ì„
- ğŸ§¹ **ì „ì²˜ë¦¬**: í´ë¦° + ì¤‘ë³µ/ê²°ì¸¡/ì´ìƒì¹˜ ì²˜ë¦¬ + ê²Œì´íŠ¸ ê²€ì¦
- ğŸ“Š **ì—‘ì…€ ìë™í™”**: ìì—°ì–´ â†’ í”¼ë²—/ì°¨íŠ¸ ìƒì„±
- âœ… **ê²€ì¦**: DSL ê¸°ë°˜ ë°ì´í„° í’ˆì§ˆ ê²€ì‚¬
- ğŸ“œ **ë¡œê·¸/ë¦¬í¬íŠ¸**: KPI ë° ì‹¤í–‰ ê²°ê³¼ í™•ì¸

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

ë°ì´í„° í”„ë¡œíŒŒì¼ë§ ë° ì „ì²˜ë¦¬ë¥¼ ìœ„í•œ Python ë„êµ¬ì…ë‹ˆë‹¤.

## ğŸš€ ì£¼ìš” ê¸°ëŠ¥

### M0.5 (í˜„ì¬ êµ¬í˜„ ì™„ë£Œ)
- **ë°ì´í„° í”„ë¡œíŒŒì¼ë§**: íƒ€ì… ì¶”ë¡ , í†µê³„ ë¶„ì„, ìƒ˜í”Œë§
- **ë ˆë²¨ 1 í´ë¦¬ë‹**: ì—´ëª… í‘œì¤€í™”, ê³µë°± ì •ë¦¬, í†µí™” ë¶„ë¦¬, ë‚ ì§œ í‘œì¤€í™”
- **ì¤‘ë³µ ì œê±°**: ë‹¤ì–‘í•œ ë³´ì¡´ ì •ì±… ì§€ì›

### M1 (ìŠ¤ì¼ˆë ˆí†¤ êµ¬í˜„)
- **ê²°ì¸¡ì¹˜ ì²˜ë¦¬**: ë‹¤ì–‘í•œ ì „ëµ (í‰ê· , ì¤‘ì•™ê°’, ìµœë¹ˆê°’ ë“±)
- **ì´ìƒì¹˜ ì²˜ë¦¬**: IQR, Z-score, Isolation Forest
- **ìŠ¤í‚¤ë§ˆ ì •ë ¬**: ì—¬ëŸ¬ íŒŒì¼ì˜ ìŠ¤í‚¤ë§ˆ ìë™ ì •ë ¬ ë° ë³‘í•©

### M2 (ê¸°ë³¸ êµ¬ì¡°)
- **ë ˆì‹œí”¼ ì‹œìŠ¤í…œ**: ì „ì²˜ë¦¬ ì‘ì—… ì €ì¥ ë° ì¬ì‹¤í–‰

### M3 (ìì—°ì–´ íŒŒì„œ + Excel COM ì—”ì§„)
- **ìì—°ì–´ ì˜ë„ íŒŒì‹±**: ê·œì¹™ ê¸°ë°˜ + LLM ë°±ì—… (Ollama)
- **Excel COM ì—”ì§„**: Windowsì—ì„œ ì‹¤ì œ Excelë¡œ í”¼ë²—/ì°¨íŠ¸ ìƒì„±
- **í•˜ì´ë¸Œë¦¬ë“œ íŒŒì„œ**: ê·œì¹™ â†’ LLM â†’ í´ë°± ìˆœì„œë¡œ ì˜ë„ í•´ì„

### M4 (KPI ìë™í™” + UI + CI)
- **KPI ìë™ ì§‘ê³„**: ê²°ì¸¡ë¥ Â·ì¤‘ë³µë¥ Â·íƒ€ì… íŒŒì‹±ìœ¨, ì²˜ë¦¬ ì‹œê°„ ì¸¡ì •
- **Streamlit UI**: íŒŒì¼ ê²½ë¡œ ì…ë ¥ â†’ í”„ë¡œíŒŒì¼ ìš”ì•½ â†’ ì²´í¬ë°•ìŠ¤ë¡œ ì ìš© â†’ ë¯¸ë¦¬ë³´ê¸° â†’ ì €ì¥
- **CI íŒŒì´í”„ë¼ì¸**: GitHub Actionsë¡œ ìœˆë„ìš°/ìš°ë¶„íˆ¬ ë§¤íŠ¸ë¦­ìŠ¤ ë¹Œë“œ
- **í•„í„°Â·ë§¤í•‘ ê°•í™”**: ìì—°ì–´ í•„í„° + ì—´ëª… ìë™ ë§¤í•‘ìœ¼ë¡œ ì •í™•ë„ í–¥ìƒ

## ğŸ“¦ ì„¤ì¹˜

### ê¸°ë³¸ ì„¤ì¹˜
```bash
pip install -r requirements.txt
```

### ìì—°ì–´ íŒŒì„œ ì„¤ì • (ì„ íƒì‚¬í•­)
```bash
# PowerShellì—ì„œ ì‹¤í–‰
.\install_ollama.ps1

# ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ
winget install Ollama.Ollama
ollama serve
ollama pull qwen2.5:3b-instruct

# ëª¨ë¸ ë³€ê²½
$env:SEC_LLM_MODEL="llama3.2:3b-instruct"  # ë‹¤ë¥¸ ëª¨ë¸ ì‚¬ìš©
ollama pull llama3.2:3b-instruct
```

### ì½˜ì†” í•œê¸€ ì„¤ì •
```bash
# PowerShellì—ì„œ ì‹¤í–‰
.\setup_console.ps1
```

### LLM ëª¨ë¸ í™˜ê²½ë³€ìˆ˜ ì„¤ì •
```bash
# PowerShellì—ì„œ ì‹¤í–‰
.\set_env.ps1

# ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ
$env:SEC_LLM_MODEL="qwen2.5:3b-instruct"
```

## ğŸ¯ ì‚¬ìš©ë²•

### 1. ê¸°ë³¸ ì‚¬ìš© (Python ëª¨ë“ˆ)

```python
from app.io.loader import load_table
from app.core.profile import profile_dataframe
from app.excel_ops.clean import level1_clean
from app.excel_ops.dedupe import dedupe

# íŒŒì¼ ë¡œë“œ
df = load_table('data/sample.csv')

# í”„ë¡œíŒŒì¼ë§
profile = profile_dataframe(df)

# í´ë¦¬ë‹
df_cleaned = level1_clean(df, currency_split=True, date_fmt='YYYY-MM-DD')

# ì¤‘ë³µ ì œê±°
df_deduped = dedupe(df_cleaned, keys=['ID'], keep_policy='last_by:ì—…ë°ì´íŠ¸ì¼')
```

### 2. ëª…ë ¹í–‰ ì¸í„°í˜ì´ìŠ¤ (CLI)

```bash
# ë°ì´í„° í”„ë¡œíŒŒì¼ë§
python -m app.cli profile data/sample.csv

# ë°ì´í„° í´ë¦¬ë‹
python -m app.cli clean data/sample.csv --apply --output cleaned.csv

# ì¤‘ë³µ ì œê±°
python -m app.cli dedupe data/sample.csv --keys "ID,ë‚ ì§œ" --keep last_by:ì—…ë°ì´íŠ¸ì¼

# ê²°ì¸¡ì¹˜ ì²˜ë¦¬
python -m app.cli impute data/sample.csv --strategy median --columns "ìˆ˜ëŸ‰,ê¸ˆì•¡"

# ì´ìƒì¹˜ ì²˜ë¦¬
python -m app.cli outlier data/sample.csv --method iqr --action clip

# ìŠ¤í‚¤ë§ˆ ì •ë ¬ ë° ë³‘í•©
python -m app.cli schema data1.csv data2.csv --strategy auto --merge

# ìì—°ì–´ë¡œ í”¼ë²—/ì°¨íŠ¸ ìƒì„± (Fallback ì—”ì§„)
python -m app.cli excel-auto --path data/sample.csv --ask "ì›”ë³„ ì¹´í…Œê³ ë¦¬ ë§¤ì¶œ í”¼ë²— ë§Œë“¤ê³  ë§‰ëŒ€ì°¨íŠ¸"

# íŒŒì„œ ì„ íƒ ì˜µì…˜
python -m app.cli excel-auto --path data/sample.csv --ask "ì›”ë³„ ì¹´í…Œê³ ë¦¬ ë§¤ì¶œ í”¼ë²— ë§Œë“¤ê³  ë§‰ëŒ€ì°¨íŠ¸" --parser rule    # ê·œì¹™ íŒŒì„œë§Œ
python -m app.cli excel-auto --path data/sample.csv --ask "ì›”ë³„ ì¹´í…Œê³ ë¦¬ ë§¤ì¶œ í”¼ë²— ë§Œë“¤ê³  ë§‰ëŒ€ì°¨íŠ¸" --parser llm     # LLM íŒŒì„œ ê°•ì œ

# ìì—°ì–´ í•„í„° (ì§€ì—­, ì¹´í…Œê³ ë¦¬ ë“±)
python -m app.cli excel-auto --path data/sample.csv --ask "ì›”ë³„ ì¹´í…Œê³ ë¦¬ ë§¤ì¶œ í”¼ë²—, ì§€ì—­ì€ ì„œìš¸ê³¼ ë¶€ì‚°ë§Œ" --parser rule

# Excel COM ì—”ì§„ ì‚¬ìš© (Windows + Excel ì„¤ì¹˜ ì‹œ)
python -m app.cli excel-auto --path data/sample.csv --ask "ì›”ë³„ ì¹´í…Œê³ ë¦¬ ë§¤ì¶œ í”¼ë²— ë§Œë“¤ê³  ë§‰ëŒ€ì°¨íŠ¸" --engine com

# KPI ìë™ ì§‘ê³„
python tools/eval_kpi.py

# Streamlit UI ì‹¤í–‰
streamlit run tools/ui_app.py
```

### 3. ë°ëª¨ ì‹¤í–‰

```bash
python tests/demo_run.py
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
smart_excel_copilot/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ core/           # í•µì‹¬ ê¸°ëŠ¥ (í”„ë¡œíŒŒì¼ë§)
â”‚   â”œâ”€â”€ excel_ops/      # ì „ì²˜ë¦¬ ì‘ì—…
â”‚   â”œâ”€â”€ io/             # íŒŒì¼ ì…ì¶œë ¥
â”‚   â”œâ”€â”€ recipes/        # ë ˆì‹œí”¼ ì‹œìŠ¤í…œ
â”‚   â””â”€â”€ cli.py          # ëª…ë ¹í–‰ ì¸í„°í˜ì´ìŠ¤
â”œâ”€â”€ data/
â”‚   â””â”€â”€ samples/        # ìƒ˜í”Œ ë°ì´í„°
â”œâ”€â”€ tests/              # í…ŒìŠ¤íŠ¸ íŒŒì¼
â””â”€â”€ requirements.txt    # ì˜ì¡´ì„±
```

## ğŸ”§ ì£¼ìš” ëª¨ë“ˆ

### `app.core.profile`
- ë°ì´í„°í”„ë ˆì„ í”„ë¡œíŒŒì¼ë§
- íƒ€ì… ì¶”ë¡  (ìˆ«ì, ë‚ ì§œ, í†µí™”, ë¶ˆë¦¬ì–¸, ë²”ì£¼í˜•)
- í†µê³„ ì •ë³´ ìƒì„±

### `app.excel_ops.clean`
- ì—´ëª… í‘œì¤€í™” (snake_case)
- ê³µë°± ì •ë¦¬
- í†µí™” ë¶„ë¦¬ (â‚©, $, ì› ë“±)
- ë‚ ì§œ í‘œì¤€í™” (YYYY-MM-DD)
- ë¶ˆë¦¬ì–¸ í‘œì¤€í™” (True/False)

### `app.excel_ops.dedupe`
- ë‹¤ì¤‘ í‚¤ ì§€ì›
- ë³´ì¡´ ì •ì±…: first, last, last_by:ì—´ëª…
- ì¤‘ë³µ í˜„í™© ë¶„ì„

### `app.excel_ops.impute`
- ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ì „ëµ
- ìë™ ì „ëµ ì œì•ˆ
- íŒ¨í„´ ë¶„ì„

### `app.excel_ops.outlier`
- ì´ìƒì¹˜ íƒì§€ (IQR, Z-score)
- ì²˜ë¦¬ ë°©ë²• (clip, remove, mark)
- í†µê³„ ìš”ì•½

### `app.excel_ops.schema`
- ìŠ¤í‚¤ë§ˆ ì •ë ¬ ì „ëµ
- ìë™ ë§¤í•‘
- íŒŒì¼ ë³‘í•©

## ğŸ“Š ì§€ì› íŒŒì¼ í˜•ì‹

- **CSV**: UTF-8, UTF-8 BOM, cp949 ìë™ ê°ì§€
- **Excel**: .xlsx, .xls

## ğŸ¨ ì˜ˆì‹œ ë°ì´í„°

`data/samples/transactions_utf8.csv` íŒŒì¼ì—ëŠ” ë‹¤ìŒ ì‹œë‚˜ë¦¬ì˜¤ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤:
- ë‹¤ì–‘í•œ ë‚ ì§œ í˜•ì‹
- í†µí™” ê¸°í˜¸ê°€ í¬í•¨ëœ ê¸ˆì•¡
- ì¤‘ë³µ ë°ì´í„°
- ê²°ì¸¡ì¹˜
- ì „ê°/ë°˜ê° ë¬¸ì í˜¼ì¬

## ğŸš§ ê°œë°œ ìƒíƒœ

- âœ… M0.5: ì™„ì „ êµ¬í˜„
- ğŸ”„ M1: ìŠ¤ì¼ˆë ˆí†¤ êµ¬í˜„ (ê¸°ë³¸ ê¸°ëŠ¥)
- ğŸ”„ M2: ê¸°ë³¸ êµ¬ì¡° (ë ˆì‹œí”¼ ì‹œìŠ¤í…œ)

## ğŸ¤ ê¸°ì—¬

ë²„ê·¸ ë¦¬í¬íŠ¸ë‚˜ ê¸°ëŠ¥ ì œì•ˆì€ ì´ìŠˆë¡œ ë“±ë¡í•´ ì£¼ì„¸ìš”.

## ğŸ“„ ë¼ì´ì„ ìŠ¤

MIT License
